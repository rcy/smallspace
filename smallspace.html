<head>
  <title>smallspace</title>
</head>

<body>
  <div class="container">
    <div class="row">
      {{> header}}
    </div>
    {{#if currentUser}}
      {{#if currentSpace}}
        {{> space}}
      {{else}}
        {{> spaceList}}
      {{/if}}
    {{else}}
      {{#unless loggingIn}}
      <div class="hero-unit">
        <h1>Welcome to smallspace</h1>
        <p></p>
        <img src="http://lorempixel.com/1200/400" />
      </div>
      {{/unless}}
    {{/if}}
  </div>
</body>

<template name="header">
  <h2>
    <a href="#" class="title">smallspace</a>
    <span>
      {{currentSpace}}
    </span>
    <span class="pull-right">
      {{loginButtons align="right"}}
    </span>
  </h2>
  <hr>
</template>

<template name="spaceList">
  <button class="pull-right btn btn-small new">create new space</button>
  <p class="lead">Welcome to smallspace.</p>
  <hr>

  <ul class="thumbnails">
    {{#each spaces}}
      {{> spaceListItem}}
    {{/each}}
  </ul>
</template>

<template name="spaceListItem">
  <li class="span2">
    <div class="thumbnail {{isInvited}}">
      <img width="200px" src="{{image}}" alt="">
      <h3>{{name}}</h3>
      <p>last activity {{updated}}</p>
      <p>{{description}}</p>
      {{#if isInvited}}
        <hr>
        <p>You have been invited to this space:</p>
        <button class="accept-invite  btn btn-small btn-primary">accept</button>
        <button class="decline-invite btn btn-small">decline</button>
      {{/if}}
    </div>
  </li>
</template>

<template name="space">
  {{#if isMember}}
    <div class="row">
      <div class="span6">
        {{> chatWindow}}
      </div>
      <div class="span6">
        {{> rightSideNav}}
      </div>
    </div>
  {{else}}
    <div>
      sorry you are not allowed here
    </div>
  {{/if}}
</template>

<template name="rightSideNav">
  <ul class="nav nav-tabs" id="myTab">
    <li class="active"><a href="#links" data-toggle="tab">Links</a></li>
    <li><a href="#users" data-toggle="tab">Users</a></li>
  </ul>

  <div class="tab-content">
    <div class="tab-pane active" id="links">
      {{> links}}
    </div>
    <div class="tab-pane" id="users">
      {{> users}}
    </div>
  </div>
</template>

<template name="users">
  <h4>Members</h4>
  <ul>
    {{#each members}}
      {{> memberListItem}}
    {{/each}}
  </ul>

  <h4>Invitations</h4>
  <form class="invite form-inline">
    <label>Invite by email:</label>
    <input type="email" />
    <button class="btn" type="submit">Send</button>
  </form>
  <ul>
    {{#each invites}}
      {{> inviteListItem}}
    {{else}}
      <em>No current invitations</em>
    {{/each}}
  </ul>
</template>

<template name="memberListItem">
  <li>{{username}}</li>
</template>

<template name="inviteListItem">
  <li><b>{{email}}</b> was invited {{when}}. <a href="#" class="cancel">cancel invitation</a></li>
</template>


<template name="links">
  <div class="links">
    {{#each links}}
    {{> link}}
    {{/each}}
  </div>
</template>

<template name="link">
  <div class="link">
    {{#if inline}}
    <div>{{{inline}}}</div>
    {{/if}}
    <div>{{{link}}}</div>
    <div>
      posted by <strong>{{user}}</strong> {{when}}
      {{#if isOwner}}
        <a href="#" class="small delete">remove</a>
      {{/if}}
    </div>
  </div>
  <hr>
</template>

<template name="chatWindow">
  <div class="chat-container">
    <div class="chat">
      {{#each messages}}
      {{> message}}
      {{/each}}
    </div>

    <form>
      <input id="abc" autofocus="1" class="span6" type="text" />
    </form>
  </div>
</template>

<template name="message">
  <div class="message">
    {{when}} &lt;<strong>{{user}}</strong>&gt; {{text}}
  </div>
</template>
